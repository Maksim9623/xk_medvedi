{% extends "base.html" %}

{% block title %}Главная{% endblock %}

{% block content %}
<div class="dashboard">
    <h1>Добро пожаловать, {{ current_user.get_full_name() }}!</h1>
    
    <div class="dashboard-section">
        <h2>Ближайшие события</h2>
        {% if events %}
            <div class="events-grid">
                {% for event in events %}
                <div class="event-card">
                    <h3>{{ event.title }}</h3>
                    <p><strong>Тип:</strong> {{ 'Игра' if event.event_type == 'game' else 'Тренировка' }}</p>
                    <p><strong>Когда:</strong> {{ event.datetime.strftime('%d.%m.%Y %H:%M') }}</p>
                    <p><strong>Где:</strong> {{ event.location }}</p>
                    {% if event.opponent %}
                    <p><strong>Соперник:</strong> {{ event.opponent }}</p>
                    {% endif %}
                    
                    <div class="response-status">
                        <strong>Ваш статус:</strong>
                        {% if user_responses[event.id] == 'attending' %}
                            <span class="status-attending">Буду</span>
                        {% elif user_responses[event.id] == 'not_attending' %}
                            <span class="status-not-attending">Не буду</span>
                        {% elif user_responses[event.id] == 'maybe' %}
                            <span class="status-maybe">Возможно</span>
                        {% else %}
                            <span class="status-not-responded">Не ответил</span>
                        {% endif %}
                    </div>
                    
                    {% if user_lineups.get(event.id) %}
                    <div class="lineup-status">
                        <strong>Ваша позиция в составе:</strong>
                        <span class="position-badge">{{ user_lineups[event.id].position }}</span>
                        {% if user_lineups[event.id].line %}
                            <span class="line-badge">{{ user_lineups[event.id].line }} звено</span>
                        {% endif %}
                    </div>
                    {% endif %}
                    
                    <a href="{{ url_for('event_detail', event_id=event.id) }}" class="btn">
                        Подробнее
                    </a>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p>Нет предстоящих событий.</p>
        {% endif %}
    </div>
</div>
{% endblock %}